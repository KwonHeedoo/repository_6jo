<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.scit6jo.web.dao.MypageMapper">
	<insert id="saveSchedule" parameterType="Schedule">
		 INSERT INTO schedule(
		 	 userid
		 	, title
		 	<if test="allDay!=null">
		 	, allday
		 	</if>
		 	<if test="endDate!=null">
		 	, enddate
		 	</if>
		 	, startdate
		 	, s_id
		 )VALUES(
		 	 #{userid}
		 	, #{title}
		 	<if test="allDay!=null">
		 	, #{allDay}
		 	</if>
		 	<if test="endDate!=null">
		 	, #{endDate}
		 	</if>
		 	, #{startDate}
		 	, schedule_seq.nextval)
	</insert>
	
	<select id="getSchedule" parameterType="String" resultType="Schedule">
		SELECT 
			title
			, allday as allDay
			, startdate as startDate
			, enddate as endDate
			, s_id
		from 
			schedule
		where 
			userid = #{userid}
	</select>
	
	<update id="updateSchedule" parameterType="Schedule">
		 update 
		 	SCHEDULE 
		 SET
		    userid = #{userid}
		    ,title = #{title}
	 	<if test="allDay!=null">    
		    ,allDay =#{allDay}
		</if>
		    ,startdate =  #{startDate}
		<if test="endDate!=null">
		    ,enddate = #{endDate}
		</if>
		where
		    s_id =#{s_id}
	</update>
	
	<update id="updateAppointment" parameterType="Schedule">
		 update 
		 	SCHEDULE 
		 SET
		    startdate =  #{startDate}
		where
		    userid = #{userid}
			and
		    title = #{title}
	</update>
	
	<delete id="removeSchedule" parameterType="Schedule">
		DELETE FROM 
			schedule
		<choose>
		<when test="s_id!=null">
		where 
			s_id = #{s_id}
		</when>
		<when test="title!=null and userid!=null">
		where 
			title = #{title} 
		and 
			userid = #{userid}
		</when>
		</choose>
	</delete>
</mapper>
