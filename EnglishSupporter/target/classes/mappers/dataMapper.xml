<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.scit6jo.web.dao.DataMapper">

	<!-- 전체 인터뷰 질문 개수 -->
	<select id="getTotal" resultType="int">
		select 
			count(*) 
		from 
			interview_question
	</select>
	
	<!-- 관리자페이지 단어 추가 -->
	<insert id="addQuestion" parameterType="IQuestion">
		insert into 
			interview_question(
				question
				, questionnum
		)values(
			#{question}
			, inter_question_seq.nextval)
	</insert>
	
	<!-- 관리자페이지 단어 업데이트 -->
	<update id="updateQuestion" parameterType="IQuestion">
		update 
			interview_question
		set 
			question = #{question}
		where 
			questionnum = #{questionNum}		
	</update>
	
	<!-- 관리자페이지 단어 삭제 -->
	<delete id="deleteQuestion" parameterType="IQuestion">
		delete from 
			interview_question 
		where 
			questionnum = #{questionNum}
	</delete>

	<insert id="insertIData" parameterType="iData">
		<selectKey keyProperty="dataNum" resultType="Integer" order="BEFORE"> 
			SELECT data_seq.nextval FROM dual 
		</selectKey>
		INSERT INTO 
			INTERVIEW_DATA(
				dataNum
				, userid
				, questionNum
				, answer
				, regdate
				, saveFile
				, confidence
		)VALUES(
			#{dataNum}
			, #{userid}
			, #{questionNum}
			, #{answer}
			, sysdate
			, #{saveFile}
			, #{confidence}
		)
	
	</insert>
	<update id="updateAnswer" parameterType="iData">
		UPDATE 
			INTERVIEW_DATA
		SET 
			answer = #{answer}
		WHERE
			dataNum = #{dataNum}
	
	</update>
	
	<update id="updateConfidence" parameterType="iData">
		UPDATE 
			INTERVIEW_DATA
		SET 
			confidence = #{confidence}
		WHERE
			dataNum = #{dataNum}
	</update>
	
	
	<select id="selectAllQuestion" resultType="iQuestion">
		select
			questionNum
			, question
		from
			interview_question
		order by questionNum asc	
		
	</select>
	
	<select id="selectOneQuestion" parameterType="int" resultType="iQuestion">
		select
			questionNum
			, question
		from
			interview_question
		where
			questionNum = #{value}
	</select>
	<select id="selectOneIData" resultType="iData" parameterType="int">
		select
			dataNum
			, userid
			, questionNum
			, answer
			, regdate
			, saveFile
			, confidence
		from
			INTERVIEW_DATA
		where
			dataNum = #{value}
	</select>
	
	<select id="selectAllIData" resultType="iData" parameterType="string">
		select
			dataNum
			, userid
			, questionNum
			, answer
			, regdate
			, saveFile
			, confidence
		from
			INTERVIEW_DATA
		where
			userid = #{value}
		order by 
			regdate desc
	</select>
</mapper>
