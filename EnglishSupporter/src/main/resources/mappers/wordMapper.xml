<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.scit6jo.web.dao.WordMapper">
	
	<!-- 예외 단어 리스트 요청 -->
	<select id="exceptionWord" resultType="string">
		select
			word
		from
			exceptionword
		where
			status = 1
	</select>
	
	<select id="selectAllWord" resultType="Word" parameterType="map">
		select w.word, w.wordnum, w.meaningk, w.meaningj, w.wordlevel, m.wordtype 
		from word w 
        left outer join 
        (select word, wordtype from myword where userid =#{userid} and wordtype='star') m
        on w.word = m.word
		where wordlevel=#{wordlevel}
		order by w.word
	
	</select>
	
	<select id="getMyWords" resultType="Word" parameterType="String">
		select myword_no, word, meaningk, meaningJ, wordtype 
		from myword 
		where userid=#{userid}
		order by word
		
	</select>
	
	<insert id="insertMyWord" parameterType="Word">
		insert into myword(
			userid
			,word
			,meaningK
			,meaningJ
			,wordtype
			,myword_no
		)values(
			#{userid}
			,#{word}
			,#{meaningK}
			,#{meaningJ}
			,#{wordtype}
			,MYWORD_SEQ.NEXTVAL
		)
	</insert>
	
	<!-- [마이페이지] 전체 내단어 개수 -->
	<select id="getMyTotal" resultType="int">
		select count(*) from myword
	</select>
	
	<!-- [마이페이지] 내단어장 업데이트 -->
	<update id="updateMyWord" parameterType="Word">
		update myword
		set word = #{word}, meaningK = #{meaningK}
		where userid = #{userid} and myword_no = #{myword_no}		
	</update>
	
	<!-- [마이페이지] 내단어장 삭제 -->
	<delete id="deleteMyWord" parameterType="Word">
		delete from myword 
		<choose>
			<when test="myword_no==null">
			where userid = #{userid} and word=#{word}
			</when>
			<when test="myword_no!=null">
			where userid =#{userid} and myword_no = #{myword_no}
			</when>
		</choose>
	</delete>
	
	<!-- [관리자페이지] 전체 단어 개수 -->
	<select id="getTotal" resultType="int">
		select count(*) from word
	</select>
	
	<!-- [관리자페이지] 전체 단어 불러오기 -->
	<select id="selectAll" resultType="Word" parameterType="String">
		select word, wordnum, meaningk, wordlevel
		from word
		where wordlevel=#{wordlevel}
		order by wordnum
	</select>
	
	<!-- [관리자페이지] 단어 추가 -->
	<insert id="addWord" parameterType="Word">
		insert into word(
			word,
			wordnum,
			meaningk,
			wordlevel
		)values(
			#{word},
			wordnum_seq.nextval,
			#{meaningK},
			#{wordlevel}
		)
	</insert>
	
	<!-- [관리자페이지] 단어 업데이트 -->
	<update id="updateWord" parameterType="Word">
		update word
		set word = #{word}, meaningK = #{meaningK}
		where wordnum = #{wordNum}		
	</update>
	
	<!-- [관리자페이지] 단어 삭제 -->
	<delete id="deleteWord" parameterType="Word">
		delete from word 
		where wordnum = #{wordNum}
	</delete>
</mapper>
